# AI Timeline Assistant

这是一个为Chrome/Edge浏览器开发的插件，支持Gemini和DeepSeek平台，用于解决AI对话过程中的一个痛点：当对话很长时，难以快速查看和跳转到之前的问题。

## 🚀 功能特点

### 核心功能
- **纯问题时间线**：智能提取当前对话中的所有用户问题，完全排除AI回答，确保时间线只显示纯粹的问题内容
- **零内容过滤**：基于DOM结构识别，不依赖文本内容判断，确保所有用户问题都能被准确捕获（包括"你好"、"范围"等简短问题）
- **快速跳转**：点击时间线上的问题，自动滚动到对话中的对应位置，支持平滑滚动和高亮显示
- **实时搜索**：内置搜索功能，支持关键词快速定位特定问题
- **倒序显示**：新问题显示在时间线顶部，方便查看最近的对话内容

### 界面特性
- **大容量显示**：支持显示多达100个问题（而非传统的10个限制）
- **现代化UI**：美观的渐变标题栏、搜索框、悬停效果和点击反馈
- **智能计数**：实时显示问题总数和搜索匹配数量
- **可折叠设计**：支持折叠/展开时间线，不干扰正常浏览
- **响应式布局**：适配不同屏幕尺寸，固定在页面右侧

### 智能更新
- **多触发机制**：
  - 检测Enter键发送问题后自动更新
  - 监听发送按钮点击事件
  - 滚动到顶部时触发历史内容加载
  - MutationObserver实时监听DOM变化
- **防重复机制**：智能去重，避免重复显示相同问题
- **性能优化**：冷却时间控制，避免过度频繁的扫描

## 📦 安装方法

### Chrome浏览器
1. 打开Chrome浏览器
2. 输入 `chrome://extensions/` 进入扩展管理页面
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本插件的文件夹
6. 插件安装完成

### Edge浏览器
1. 打开Edge浏览器
2. 输入 `edge://extensions/` 进入扩展管理页面
3. 开启左下角的"开发人员模式"
4. 点击"加载解压缩的扩展"
5. 选择本插件的文件夹
6. 插件安装完成

## 🎯 使用方法

### 基本使用
1. 打开支持的AI对话页面：
   - Gemini: `https://gemini.google.com/`
   - DeepSeek: `https://chat.deepseek.com/`
2. 开始与AI对话
3. 插件会自动检测平台并在页面右侧显示时间线容器
4. 时间线会实时显示您的所有问题，新问题出现在顶部

### 搜索功能
1. 在时间线顶部的搜索框中输入关键词
2. 时间线会实时过滤显示匹配的问题
3. 搜索结果会显示"匹配数/总数"的格式
4. 清空搜索框可恢复显示所有问题

### 快速跳转
1. 点击时间线中的任意问题
2. 页面会自动滚动到对应的问题位置
3. 目标问题会短暂高亮显示（2秒）
4. 支持平滑滚动动画效果

### 界面控制
- **折叠/展开**：点击标题栏右侧的"−"/"+"按钮
- **问题计数**：标题栏显示当前问题总数
- **悬停效果**：鼠标悬停在问题上会有视觉反馈
- **文本选择**：支持直接选择和复制问题文本

## 🔧 技术特性

### 智能平台适配
插件采用智能适配策略，根据不同AI平台使用相应的DOM选择器：

**Gemini平台选择器：**
- `[data-message-author-role="user"]` - 用户消息容器
- `user-query-content` - 用户查询内容标签
- `.user-query-bubble-with-background` - 用户问题气泡
- `.query-text` - 问题文本容器

**DeepSeek平台选择器：**
- `[data-role="user"]` - 用户角色标识
- `.user-message` - 用户消息类
- `.message-user` - 用户消息容器
- `[class*="user"]` - 包含用户关键词的类

### 过滤策略
- **零内容过滤**：不基于文本内容进行判断
- **系统错误排除**：只过滤明显的系统错误信息（如连接错误、Request ID等）
- **结构优先**：完全依赖DOM结构而非文本特征

### 性能优化
- **防抖机制**：避免频繁的DOM扫描
- **智能去重**：基于文本指纹避免重复显示
- **分层监听**：多种触发机制确保及时更新
- **内存管理**：限制显示数量，避免内存溢出

## 🐛 调试模式

如果插件没有正确显示您的问题，可以打开浏览器的开发者工具（按F12），切换到"控制台"选项卡，查看插件的运行日志：

### 关键日志信息
```
=== Gemini Timeline: 开始扫描用户问题（零过滤版本）===
Gemini Timeline: 选择器 "user-query-content" 找到 X 个元素
Gemini Timeline: ✅ 找到用户问题: "您的问题内容"
Gemini Timeline: 🚀 跳过所有内容过滤，直接使用DOM检测结果: X 条
Gemini Timeline: 成功渲染 X 条问题
```

### 常见问题排查
- **时间线不显示**：检查是否在Gemini页面，尝试刷新页面
- **问题遗漏**：查看控制台日志，确认DOM选择器是否匹配
- **重复问题**：正常现象，插件会自动去重处理
- **搜索无结果**：检查搜索关键词是否正确，支持部分匹配

## 📁 文件结构

```
chrome插件/
├── manifest.json          # 插件配置文件
├── content.js             # 核心功能实现（593行）
├── style.css              # 时间线样式
├── background.js          # 后台服务
├── popup.html             # 弹窗界面
├── images/
│   └── icon.svg          # 插件图标
├── README.md             # 中文说明文档
├── README_EN.md          # 英文说明文档（即将生成）
└── INSTALL_GUIDE.md      # 安装指南
```

## 🔄 更新历史

### v1.1 最新版本特性
- 🆕 **DeepSeek支持**：新增对DeepSeek平台的完整支持
- 🆕 **智能平台适配**：自动检测并适配不同AI平台
- ✅ **零内容过滤**：完全基于DOM结构，不会误过滤任何用户问题
- ✅ **搜索功能**：实时搜索和过滤问题
- ✅ **100个问题显示**：从10个增加到100个问题容量
- ✅ **倒序显示**：新问题在顶部显示
- ✅ **现代化UI**：美观的界面设计和交互效果
- ✅ **智能更新**：多种触发机制确保实时更新
- ✅ **性能优化**：防抖、去重、内存管理等优化

### 解决的问题
1. **过滤过度**：之前版本会误过滤短问题（如"你好"、"范围"），现已完全解决
2. **容量限制**：从10个问题限制提升到100个
3. **更新不及时**：新增多种自动更新触发机制
4. **界面简陋**：重新设计了现代化的UI界面
5. **缺少搜索**：新增实时搜索功能

## 🚨 注意事项

- 本插件支持以下AI平台：
  - Gemini (`gemini.google.com`)
  - DeepSeek (`chat.deepseek.com`)
- 插件会自动检测平台并适配相应的DOM结构
- 建议定期更新插件以保持最佳兼容性
- 如遇问题，可通过控制台日志进行排查
- 插件不会收集或存储任何用户数据
- 所有数据均存储在本地浏览器中

## 🛠️ 开发说明

### 核心文件说明
- **content.js**：主要逻辑文件，包含DOM检测、时间线渲染、搜索功能等
- **style.css**：时间线样式，支持文本选择和现代化UI
- **manifest.json**：插件配置，支持Manifest V3
- **background.js**：后台服务，处理插件生命周期
- **popup.html**：插件弹窗界面

### 自定义开发
如需修改插件功能，主要关注以下函数：
- `scanQuestions()`：问题扫描和检测逻辑
- `renderTimeline()`：时间线渲染和UI生成
- `setupSearch()`：搜索功能实现
- `observePageChanges()`：页面变化监听

## 📞 反馈与支持

如果您在使用过程中遇到问题或有任何建议，请通过以下方式反馈：
- 提交Issue到项目仓库
- 查看控制台日志进行自主排查
- 参考本文档的调试模式部分

---

**开发理念**：专注解决AI长对话中的问题跳转痛点，提供跨平台、纯净、高效、智能的问题时间线体验。